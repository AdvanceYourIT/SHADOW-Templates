{
  "name": "CF-UltraTreesizeNinja",
  "description": "https://github.com/freezscholte/Public-Ninja-Scripts/blob/main/CF-Treesize/CF-UltraTreesizeNinja.ps1",
  "categoriesIds": [
    3
  ],
  "architecture": [
    "64",
    "32"
  ],
  "language": "powershell",
  "operatingSystems": [
    "Windows"
  ],
  "code": "CjwjCi5TWU5PUFNJUwogICAgQ2FsY3VsYXRlIHRoZSBzaXplcyBvZiBmb2xkZXJzIGZyb20gdGhlIE1hc3RlciBGaWxlIFRhYmxlIHVzaW5nIEMjIG9uIGEgZHJpdmUgYW5kIG91dHB1dCB0aGUgcmVzdWx0cyBpbiBhbiBIVE1MIHRhYmxlLgoKLkRFU0NSSVBUSU9OCiAgICBUaGlzIHNjcmlwdCBjYWxjdWxhdGVzIHRoZSBzaXplcyBvZiBmb2xkZXJzIGZyb20gdGhlIE1hc3RlciBGaWxlIFRhYmxlIChNRlQpIHVzaW5nIEMjIG9uIGEgc3BlY2lmaWVkIGRyaXZlIGFuZCBvdXRwdXRzIHRoZSByZXN1bHRzIGluIGFuIEhUTUwgdGFibGUuCiAgICBUaGUgc2NyaXB0IHVzZXMgYSBjb21waWxlZCBDIyBjbGFzcyB0byByZWFkIHRoZSBNRlQgcmVjb3JkcyBhbmQgY2FsY3VsYXRlIHRoZSBzaXplcyBvZiBmb2xkZXJzIHJlY3Vyc2l2ZWx5LgogICAgVGhlIHJlc3VsdHMgYXJlIGRpc3BsYXllZCBpbiBhbiBIVE1MIHRhYmxlIHdpdGggdGhlIHRvcCBmb2xkZXJzIGJ5IHNpemUsIGFuZCB0aGUgcm93IGNvbG9yIGlzIGJhc2VkIG9uIHRoZSBzaXplIG9mIHRoZSBmb2xkZXIuCgouTk9URVMKICAgIEZpbGUgTmFtZSAgICAgIDogQ0YtVWx0cmFUcmVlc2l6ZU5pbmphLnBzMQogICAgQXV0aG9yICAgICAgICAgOiBKYW4gU2Nob2x0ZQogICAgVmVyc2lvbiAgICAgICAgOiAwLjkuMgojPgoKQWRkLVR5cGUgLVR5cGVEZWZpbml0aW9uIEAiCnVzaW5nIFN5c3RlbTsKdXNpbmcgU3lzdGVtLkNvbGxlY3Rpb25zLkNvbmN1cnJlbnQ7CnVzaW5nIFN5c3RlbS5JTzsKdXNpbmcgU3lzdGVtLkxpbnE7CnVzaW5nIFN5c3RlbS5UaHJlYWRpbmc7CnVzaW5nIFN5c3RlbS5UaHJlYWRpbmcuVGFza3M7CnVzaW5nIFN5c3RlbS5SdW50aW1lLkludGVyb3BTZXJ2aWNlczsKdXNpbmcgU3lzdGVtLkNvbXBvbmVudE1vZGVsOwoKbmFtZXNwYWNlIEZvbGRlclNpemVDYWxjdWxhdG9yTmFtZXNwYWNlCnsKICAgIHB1YmxpYyBjbGFzcyBGaWxlU3lzdGVtSXRlbQogICAgewogICAgICAgIHB1YmxpYyBzdHJpbmcgUGF0aCB7IGdldDsgc2V0OyB9CiAgICAgICAgcHVibGljIGxvbmcgU2l6ZU9uRGlzayB7IGdldDsgc2V0OyB9CiAgICAgICAgcHVibGljIERhdGVUaW1lIENyZWF0aW9uVGltZSB7IGdldDsgc2V0OyB9CiAgICAgICAgcHVibGljIERhdGVUaW1lIExhc3RXcml0ZVRpbWUgeyBnZXQ7IHNldDsgfQogICAgICAgIHB1YmxpYyBib29sIElzRGlyZWN0b3J5IHsgZ2V0OyBzZXQ7IH0KICAgIH0KCiAgICBwdWJsaWMgY2xhc3MgRm9sZGVyU2l6ZUNhbGN1bGF0b3IKICAgIHsKICAgICAgICBwcml2YXRlIHN0cmluZyBkcml2ZUxldHRlcjsKICAgICAgICBwcml2YXRlIGludCBtYXhEZXB0aDsKICAgICAgICBwcml2YXRlIGJvb2wgdmVyYm9zZU91dHB1dDsKICAgICAgICBwcml2YXRlIGxvbmcgc2l6ZVRocmVzaG9sZDsKICAgICAgICBwdWJsaWMgQ29uY3VycmVudEJhZzxGaWxlU3lzdGVtSXRlbT4gSXRlbXMgeyBnZXQ7IHByaXZhdGUgc2V0OyB9CgogICAgICAgIHB1YmxpYyBGb2xkZXJTaXplQ2FsY3VsYXRvcihzdHJpbmcgZHJpdmVMZXR0ZXIsIGludCBtYXhEZXB0aCwgYm9vbCB2ZXJib3NlT3V0cHV0LCBsb25nIHNpemVUaHJlc2hvbGQgPSAxMDI0ICogMTAyNCkKICAgICAgICB7CiAgICAgICAgICAgIHRoaXMuZHJpdmVMZXR0ZXIgPSBkcml2ZUxldHRlcjsKICAgICAgICAgICAgdGhpcy5tYXhEZXB0aCA9IG1heERlcHRoOwogICAgICAgICAgICB0aGlzLnZlcmJvc2VPdXRwdXQgPSB2ZXJib3NlT3V0cHV0OwogICAgICAgICAgICB0aGlzLnNpemVUaHJlc2hvbGQgPSBzaXplVGhyZXNob2xkOwogICAgICAgICAgICB0aGlzLkl0ZW1zID0gbmV3IENvbmN1cnJlbnRCYWc8RmlsZVN5c3RlbUl0ZW0+KCk7CiAgICAgICAgfQoKICAgICAgICBwdWJsaWMgdm9pZCBDYWxjdWxhdGVGb2xkZXJTaXplcygpCiAgICAgICAgewogICAgICAgICAgICBEaXJlY3RvcnlJbmZvIHJvb3REaXIgPSBuZXcgRGlyZWN0b3J5SW5mbyh0aGlzLmRyaXZlTGV0dGVyICsgIjpcXCIpOwogICAgICAgICAgICBDYWxjdWxhdGVGb2xkZXJTaXplKHJvb3REaXIsIDApOwogICAgICAgIH0KCiAgICAgICAgcHJpdmF0ZSBsb25nIENhbGN1bGF0ZUZvbGRlclNpemUoRGlyZWN0b3J5SW5mbyBkaXJJbmZvLCBpbnQgY3VycmVudERlcHRoKQogICAgICAgIHsKICAgICAgICAgICAgaWYgKGN1cnJlbnREZXB0aCA+IHRoaXMubWF4RGVwdGgpCiAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgICAgICB9CgogICAgICAgICAgICBsb25nIGZvbGRlclNpemVPbkRpc2sgPSAwOwoKICAgICAgICAgICAgdmFyIHBhcmFsbGVsT3B0aW9ucyA9IG5ldyBQYXJhbGxlbE9wdGlvbnMgeyBNYXhEZWdyZWVPZlBhcmFsbGVsaXNtID0gRW52aXJvbm1lbnQuUHJvY2Vzc29yQ291bnQgfTsKCiAgICAgICAgICAgIHRyeQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAvLyBQcm9jZXNzIGZpbGVzIGluIHRoZSBjdXJyZW50IGRpcmVjdG9yeQogICAgICAgICAgICAgICAgdmFyIGZpbGVzID0gRW51bWVyYWJsZS5FbXB0eTxGaWxlSW5mbz4oKTsKICAgICAgICAgICAgICAgIHRyeQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGZpbGVzID0gZGlySW5mby5FbnVtZXJhdGVGaWxlcygpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBleCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy52ZXJib3NlT3V0cHV0KQogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgQ29uc29sZS5Xcml0ZUxpbmUoIkVycm9yIGFjY2Vzc2luZyBmaWxlcyBpbiBkaXJlY3RvcnkgezB9OiB7MX0iLCBkaXJJbmZvLkZ1bGxOYW1lLCBleC5NZXNzYWdlKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgUGFyYWxsZWwuRm9yRWFjaChmaWxlcywgcGFyYWxsZWxPcHRpb25zLCBmaWxlID0+CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdHJ5CiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBsb25nIGZpbGVTaXplT25EaXNrID0gR2V0U2l6ZU9uRGlzayhmaWxlLkZ1bGxOYW1lKTsKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBuZXcgRmlsZVN5c3RlbUl0ZW0KICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgUGF0aCA9IGZpbGUuRnVsbE5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTaXplT25EaXNrID0gZmlsZVNpemVPbkRpc2ssCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDcmVhdGlvblRpbWUgPSBmaWxlLkNyZWF0aW9uVGltZSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgIExhc3RXcml0ZVRpbWUgPSBmaWxlLkxhc3RXcml0ZVRpbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJc0RpcmVjdG9yeSA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWxlU2l6ZU9uRGlzayA+IHNpemVUaHJlc2hvbGQpCiAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEl0ZW1zLkFkZChpdGVtKTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJsb2NrZWQuQWRkKHJlZiBmb2xkZXJTaXplT25EaXNrLCBmaWxlU2l6ZU9uRGlzayk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhdGNoIChFeGNlcHRpb24gZXgpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy52ZXJib3NlT3V0cHV0KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb25zb2xlLldyaXRlTGluZSgiRXJyb3IgcHJvY2Vzc2luZyBmaWxlIHswfTogezF9IiwgZmlsZS5GdWxsTmFtZSwgZXguTWVzc2FnZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICAvLyBQcm9jZXNzIHN1YmRpcmVjdG9yaWVzCiAgICAgICAgICAgICAgICB2YXIgc3ViRGlycyA9IEVudW1lcmFibGUuRW1wdHk8RGlyZWN0b3J5SW5mbz4oKTsKICAgICAgICAgICAgICAgIHRyeQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIHN1YkRpcnMgPSBkaXJJbmZvLkVudW1lcmF0ZURpcmVjdG9yaWVzKCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBjYXRjaCAoRXhjZXB0aW9uIGV4KQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnZlcmJvc2VPdXRwdXQpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBDb25zb2xlLldyaXRlTGluZSgiRXJyb3IgYWNjZXNzaW5nIHN1YmRpcmVjdG9yaWVzIGluIGRpcmVjdG9yeSB7MH06IHsxfSIsIGRpckluZm8uRnVsbE5hbWUsIGV4Lk1lc3NhZ2UpOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBQYXJhbGxlbC5Gb3JFYWNoKHN1YkRpcnMsIHBhcmFsbGVsT3B0aW9ucywgc3ViRGlyID0+CiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdHJ5CiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBsb25nIHN1YkRpclNpemVPbkRpc2sgPSBDYWxjdWxhdGVGb2xkZXJTaXplKHN1YkRpciwgY3VycmVudERlcHRoICsgMSk7CiAgICAgICAgICAgICAgICAgICAgICAgIEludGVybG9ja2VkLkFkZChyZWYgZm9sZGVyU2l6ZU9uRGlzaywgc3ViRGlyU2l6ZU9uRGlzayk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGNhdGNoIChFeGNlcHRpb24gZXgpCiAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy52ZXJib3NlT3V0cHV0KQogICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBDb25zb2xlLldyaXRlTGluZSgiRXJyb3IgcHJvY2Vzc2luZyBkaXJlY3RvcnkgezB9OiB7MX0iLCBzdWJEaXIuRnVsbE5hbWUsIGV4Lk1lc3NhZ2UpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CgogICAgICAgICAgICAgICAgLy8gQ3JlYXRlIEZpbGVTeXN0ZW1JdGVtIGZvciB0aGUgY3VycmVudCBkaXJlY3RvcnkKICAgICAgICAgICAgICAgIHZhciBkaXJJdGVtID0gbmV3IEZpbGVTeXN0ZW1JdGVtCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgUGF0aCA9IGRpckluZm8uRnVsbE5hbWUsCiAgICAgICAgICAgICAgICAgICAgU2l6ZU9uRGlzayA9IGZvbGRlclNpemVPbkRpc2ssCiAgICAgICAgICAgICAgICAgICAgQ3JlYXRpb25UaW1lID0gZGlySW5mby5DcmVhdGlvblRpbWUsCiAgICAgICAgICAgICAgICAgICAgTGFzdFdyaXRlVGltZSA9IGRpckluZm8uTGFzdFdyaXRlVGltZSwKICAgICAgICAgICAgICAgICAgICBJc0RpcmVjdG9yeSA9IHRydWUKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgICBJdGVtcy5BZGQoZGlySXRlbSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgY2F0Y2ggKEV4Y2VwdGlvbiBleCkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaWYgKHRoaXMudmVyYm9zZU91dHB1dCkKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBDb25zb2xlLldyaXRlTGluZSgiRXJyb3IgYWNjZXNzaW5nIGRpcmVjdG9yeSB7MH06IHsxfSIsIGRpckluZm8uRnVsbE5hbWUsIGV4Lk1lc3NhZ2UpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gZm9sZGVyU2l6ZU9uRGlzazsKICAgICAgICB9CgogICAgICAgIFtEbGxJbXBvcnQoImtlcm5lbDMyLmRsbCIsIFNldExhc3RFcnJvciA9IHRydWUsIENoYXJTZXQgPSBDaGFyU2V0LkF1dG8pXQogICAgICAgIHN0YXRpYyBleHRlcm4gdWludCBHZXRDb21wcmVzc2VkRmlsZVNpemUoc3RyaW5nIGxwRmlsZU5hbWUsIG91dCB1aW50IGxwRmlsZVNpemVIaWdoKTsKCiAgICAgICAgcHVibGljIHN0YXRpYyBsb25nIEdldFNpemVPbkRpc2soc3RyaW5nIGZpbGVuYW1lKQogICAgICAgIHsKICAgICAgICAgICAgdWludCBoaWdoT3JkZXI7CiAgICAgICAgICAgIHVpbnQgbG93T3JkZXIgPSBHZXRDb21wcmVzc2VkRmlsZVNpemUoZmlsZW5hbWUsIG91dCBoaWdoT3JkZXIpOwogICAgICAgICAgICBpZiAobG93T3JkZXIgPT0gMHhGRkZGRkZGRikKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgaW50IGVycm9yID0gTWFyc2hhbC5HZXRMYXN0V2luMzJFcnJvcigpOwogICAgICAgICAgICAgICAgaWYgKGVycm9yICE9IDApCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IFdpbjMyRXhjZXB0aW9uKGVycm9yKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gKChsb25nKWhpZ2hPcmRlciA8PCAzMikgKyBsb3dPcmRlcjsKICAgICAgICB9CiAgICB9Cn0KIkAKZnVuY3Rpb24gR2V0LUZvbGRlclNpemVzIHsKICAgIHBhcmFtICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICRmYWxzZSldCiAgICAgICAgW3N0cmluZ10kRHJpdmVMZXR0ZXIsCiAgICAgICAgW2ludF0kTWF4RGVwdGggPSA1LAogICAgICAgIFtpbnRdJFRvcCA9IDIwLAogICAgICAgIFtpbnRdJE1pbkl0ZW1TaXplTUIgPSAxLAogICAgICAgIFtTd2l0Y2hdJEZvbGRlclNpemUsCiAgICAgICAgW1N3aXRjaF0kRmlsZVNpemUsCiAgICAgICAgW1N3aXRjaF0kVmVyYm9zZU91dHB1dCwKICAgICAgICBbU3dpdGNoXSRBbGxEcml2ZXMKICAgICkKCiAgICAjIFZhbGlkYXRlIHBhcmFtZXRlcnMKICAgIGlmICgtbm90ICRBbGxEcml2ZXMgLWFuZCAtbm90ICREcml2ZUxldHRlcikgewogICAgICAgIHRocm93ICJZb3UgbXVzdCBzcGVjaWZ5IGVpdGhlciAtRHJpdmVMZXR0ZXIgb3IgLUFsbERyaXZlcy4iCiAgICB9CgogICAgIyBHZXQgbGlzdCBvZiBkcml2ZXMgdG8gcHJvY2VzcwogICAgJGRyaXZlc1RvUHJvY2VzcyA9IEAoKQogICAgaWYgKCRBbGxEcml2ZXMpIHsKICAgICAgICAjIEdldCBhbGwgbG9jYWwgZHJpdmVzIChleGNsdWRpbmcgcmVtb3ZhYmxlIGFuZCBuZXR3b3JrIGRyaXZlcykKICAgICAgICAkZHJpdmVzID0gR2V0LUNpbUluc3RhbmNlIFdpbjMyX0xvZ2ljYWxEaXNrIHwgV2hlcmUtT2JqZWN0IHsKICAgICAgICAgICAgJF8uRHJpdmVUeXBlIC1lcSAzICMgRHJpdmVUeXBlIDMgPSBMb2NhbCBEaXNrCiAgICAgICAgfQogICAgICAgICRkcml2ZXNUb1Byb2Nlc3MgPSAkZHJpdmVzLkRldmljZUlECiAgICB9IGVsc2UgewogICAgICAgICRkcml2ZXNUb1Byb2Nlc3MgPSBAKCIkRHJpdmVMZXR0ZXJgOiIpICMgQWRkIGNvbG9uIHRvIG1hdGNoIHRoZSBmb3JtYXQgKGUuZy4sICJDOiIpCiAgICB9CgogICAgJGFsbFNvcnRlZEl0ZW1zID0gW1N5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLkxpc3Rbb2JqZWN0XV06Om5ldygpCgogICAgZm9yZWFjaCAoJGRyaXZlIGluICRkcml2ZXNUb1Byb2Nlc3MpIHsKICAgICAgICBpZiAoJFZlcmJvc2VPdXRwdXQpIHsKICAgICAgICAgICAgV3JpdGUtT3V0cHV0ICJQcm9jZXNzaW5nIGRyaXZlICRkcml2ZSIKICAgICAgICB9CgogICAgICAgICMgRXh0cmFjdCB0aGUgZHJpdmUgbGV0dGVyIHdpdGhvdXQgY29sb24KICAgICAgICAkZHJpdmVMZXR0ZXJPbmx5ID0gJGRyaXZlLlRyaW1FbmQoJzonKQoKICAgICAgICAkc2l6ZVRocmVzaG9sZEJ5dGVzID0gW01hdGhdOjpNYXgoMSwgJE1pbkl0ZW1TaXplTUIpICogMU1CCgogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRmb2xkZXJTaXplQ2FsY3VsYXRvciA9IE5ldy1PYmplY3QgRm9sZGVyU2l6ZUNhbGN1bGF0b3JOYW1lc3BhY2UuRm9sZGVyU2l6ZUNhbGN1bGF0b3IoJGRyaXZlTGV0dGVyT25seSwgJE1heERlcHRoLCBbYm9vbF0kVmVyYm9zZU91dHB1dCwgW2xvbmddJHNpemVUaHJlc2hvbGRCeXRlcykKICAgICAgICAgICAgJGZvbGRlclNpemVDYWxjdWxhdG9yLkNhbGN1bGF0ZUZvbGRlclNpemVzKCkKICAgICAgICAgICAgJGl0ZW1zID0gJGZvbGRlclNpemVDYWxjdWxhdG9yLkl0ZW1zCiAgICAgICAgfQogICAgICAgIGNhdGNoIHsKICAgICAgICAgICAgV3JpdGUtV2FybmluZyAiRmFpbGVkIHRvIGNhbGN1bGF0ZSBmb2xkZXIgc2l6ZXMgZm9yIGRyaXZlICRkcml2ZSA6ICRfIgogICAgICAgICAgICBjb250aW51ZQogICAgICAgIH0KCiAgICAgICAgaWYgKCRpdGVtcy5Db3VudCAtZXEgMCkgewogICAgICAgICAgICBXcml0ZS1XYXJuaW5nICJObyBpdGVtcyB3ZXJlIGZvdW5kIG9uIGRyaXZlICRkcml2ZS4gRW5zdXJlIHRoYXQgdGhlIGRyaXZlIGlzIGFjY2Vzc2libGUuIgogICAgICAgICAgICBjb250aW51ZQogICAgICAgIH0KCiAgICAgICAgIyBGaWx0ZXIgaXRlbXMgYmFzZWQgb24gcGFyYW1ldGVycwogICAgICAgICRzZWxlY3RlZEl0ZW1zID0gJGl0ZW1zCgogICAgICAgIGlmICgkRm9sZGVyU2l6ZSAtYW5kIC1ub3QgJEZpbGVTaXplKSB7CiAgICAgICAgICAgICRzZWxlY3RlZEl0ZW1zID0gJGl0ZW1zIHwgV2hlcmUtT2JqZWN0IHsgJF8uSXNEaXJlY3RvcnkgfQogICAgICAgIH0gZWxzZWlmICgkRmlsZVNpemUgLWFuZCAtbm90ICRGb2xkZXJTaXplKSB7CiAgICAgICAgICAgICRzZWxlY3RlZEl0ZW1zID0gJGl0ZW1zIHwgV2hlcmUtT2JqZWN0IHsgLW5vdCAkXy5Jc0RpcmVjdG9yeSB9CiAgICAgICAgfSBlbHNlaWYgKC1ub3QgJEZvbGRlclNpemUgLWFuZCAtbm90ICRGaWxlU2l6ZSkgewogICAgICAgICAgICAjIElmIG5laXRoZXIgaXMgc3BlY2lmaWVkLCBkZWZhdWx0IHRvIGZvbGRlcnMgb25seQogICAgICAgICAgICAkc2VsZWN0ZWRJdGVtcyA9ICRpdGVtcyB8IFdoZXJlLU9iamVjdCB7ICRfLklzRGlyZWN0b3J5IH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAjIEJvdGggRm9sZGVyU2l6ZSBhbmQgRmlsZVNpemUgYXJlIHNwZWNpZmllZDsgaW5jbHVkZSBhbGwgaXRlbXMKICAgICAgICAgICAgJHNlbGVjdGVkSXRlbXMgPSAkaXRlbXMKICAgICAgICB9CgogICAgICAgICMgUHJvY2VzcyBhbmQgc29ydCB0aGUgc2VsZWN0ZWQgaXRlbXMKICAgICAgICAkc29ydGVkSXRlbXMgPSAkc2VsZWN0ZWRJdGVtcyB8IFNvcnQtT2JqZWN0IC1Qcm9wZXJ0eSBTaXplT25EaXNrIC1EZXNjZW5kaW5nIHwgU2VsZWN0LU9iamVjdCAtRmlyc3QgJFRvcCB8IEZvckVhY2gtT2JqZWN0IHsKICAgICAgICAgICAgW1BTQ3VzdG9tT2JqZWN0XUB7CiAgICAgICAgICAgICAgICBEcml2ZSAgICAgICAgID0gJGRyaXZlCiAgICAgICAgICAgICAgICBQYXRoICAgICAgICAgID0gJF8uUGF0aAogICAgICAgICAgICAgICAgU2l6ZSAgICAgICAgICA9IENvbnZlcnQtQnl0ZXNUb1NpemUgLUJ5dGVzICRfLlNpemVPbkRpc2sKICAgICAgICAgICAgICAgIENyZWF0aW9uVGltZSAgPSAkXy5DcmVhdGlvblRpbWUKICAgICAgICAgICAgICAgIExhc3RXcml0ZVRpbWUgPSAkXy5MYXN0V3JpdGVUaW1lCiAgICAgICAgICAgICAgICBJc0RpcmVjdG9yeSAgID0gJF8uSXNEaXJlY3RvcnkKICAgICAgICAgICAgICAgIFJhd1NpemUgICAgICAgPSAkXy5TaXplT25EaXNrCiAgICAgICAgICAgICAgICBSb3dDb2xvdXIgICAgID0gc3dpdGNoICgkXy5TaXplT25EaXNrKSB7CiAgICAgICAgICAgICAgICAgICAgeyAkXyAtZ3QgMzBHQiB9IHsgImRhbmdlciI7IGJyZWFrIH0KICAgICAgICAgICAgICAgICAgICB7ICRfIC1ndCA1R0IgfSAgeyAid2FybmluZyI7IGJyZWFrIH0KICAgICAgICAgICAgICAgICAgICB7ICRfIC1ndCAxR0IgfSAgeyAiaW5mbyI7IGJyZWFrIH0KICAgICAgICAgICAgICAgICAgICBkZWZhdWx0ICAgICAgICAgeyAiZGVmYXVsdCIgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICAjIEFkZCB0aGUgc29ydGVkIGl0ZW1zIGZvciB0aGlzIGRyaXZlIHRvIHRoZSBsaXN0IG9mIGFsbCBpdGVtcwogICAgICAgICRhbGxTb3J0ZWRJdGVtcy5BZGRSYW5nZSgkc29ydGVkSXRlbXMpCiAgICB9CgogICAgIyBSZXR1cm4gYWxsIHNvcnRlZCBpdGVtcwogICAgcmV0dXJuICRhbGxTb3J0ZWRJdGVtcwp9CgpmdW5jdGlvbiBDb252ZXJ0LUJ5dGVzVG9TaXplIHsKICAgIHBhcmFtICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbbG9uZ10kQnl0ZXMKICAgICkKCiAgICAkc2l6ZXMgPSAiYnl0ZXMiLCAiS0IiLCAiTUIiLCAiR0IiLCAiVEIiLCAiUEIiLCAiRUIiCiAgICAkZmFjdG9yID0gMAoKICAgIHdoaWxlICgkQnl0ZXMgLWdlIDFLQiAtYW5kICRmYWN0b3IgLWx0ICRzaXplcy5MZW5ndGggLSAxKSB7CiAgICAgICAgJEJ5dGVzIC89IDFLQgogICAgICAgICRmYWN0b3IrKwogICAgfQoKICAgIHJldHVybiAiezA6TjJ9IHsxfSIgLWYgJEJ5dGVzLCAkc2l6ZXNbJGZhY3Rvcl0KfQpmdW5jdGlvbiBDb252ZXJ0VG8tT2JqZWN0VG9IdG1sVGFibGUgewogICAgcGFyYW0gKAogICAgICAgIFtQYXJhbWV0ZXIoTWFuZGF0b3J5ID0gJHRydWUpXQogICAgICAgIFtvYmplY3RdJE9iamVjdHMKICAgICkKCiAgICBpZiAoLW5vdCAkT2JqZWN0cykgewogICAgICAgIHJldHVybiAnPHA+Tm8gZm9sZGVycyBvciBmaWxlcyBtZXQgdGhlIHNlbGVjdGlvbiBjcml0ZXJpYS48L3A+JwogICAgfQoKICAgICRsaXN0ID0gaWYgKCRPYmplY3RzIC1pcyBbU3lzdGVtLkNvbGxlY3Rpb25zLkdlbmVyaWMuTGlzdFtvYmplY3RdXSkgewogICAgICAgICRPYmplY3RzCiAgICB9IGVsc2UgewogICAgICAgICR0ZW1wTGlzdCA9IFtTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5MaXN0W29iamVjdF1dOjpuZXcoKQogICAgICAgIGZvcmVhY2ggKCRpdGVtIGluIEAoJE9iamVjdHMpKSB7CiAgICAgICAgICAgICRudWxsID0gJHRlbXBMaXN0LkFkZCgkaXRlbSkKICAgICAgICB9CiAgICAgICAgJHRlbXBMaXN0CiAgICB9CgogICAgaWYgKCRsaXN0LkNvdW50IC1lcSAwKSB7CiAgICAgICAgcmV0dXJuICc8cD5ObyBmb2xkZXJzIG9yIGZpbGVzIG1ldCB0aGUgc2VsZWN0aW9uIGNyaXRlcmlhLjwvcD4nCiAgICB9CgogICAgJHNiID0gTmV3LU9iamVjdCBTeXN0ZW0uVGV4dC5TdHJpbmdCdWlsZGVyCiAgICBbdm9pZF0kc2IuQXBwZW5kKCc8dGFibGUgY2xhc3M9InRyZWVzaXplLXRhYmxlIj48dGhlYWQ+PHRyPicpCgogICAgJGxpc3RbMF0uUFNPYmplY3QuUHJvcGVydGllcy5OYW1lIHwKICAgICAgICBXaGVyZS1PYmplY3QgeyAkXyAtbm90aW4gQCgnUm93Q29sb3VyJywgJ1Jhd1NpemUnKSB9IHwKICAgICAgICBGb3JFYWNoLU9iamVjdCB7IFt2b2lkXSRzYi5BcHBlbmQoIjx0aD4kXzwvdGg+IikgfQoKICAgIFt2b2lkXSRzYi5BcHBlbmQoJzwvdHI+PC90aGVhZD48dGJvZHk+JykKCiAgICBmb3JlYWNoICgkb2JqIGluICRsaXN0KSB7CiAgICAgICAgJHJvd0NsYXNzID0gaWYgKCRvYmouUm93Q29sb3VyKSB7ICRvYmouUm93Q29sb3VyIH0gZWxzZSB7ICIiIH0KCiAgICAgICAgW3ZvaWRdJHNiLkFwcGVuZCgiPHRyIGNsYXNzPWAiJHJvd0NsYXNzYCI+IikKICAgICAgICBmb3JlYWNoICgkcHJvcE5hbWUgaW4gJG9iai5QU09iamVjdC5Qcm9wZXJ0aWVzLk5hbWUgfCBXaGVyZS1PYmplY3QgeyAkXyAtbm90aW4gQCgnUm93Q29sb3VyJywgJ1Jhd1NpemUnKSB9KSB7CiAgICAgICAgICAgIFt2b2lkXSRzYi5BcHBlbmQoIjx0ZD4kKCRvYmouJHByb3BOYW1lKTwvdGQ+IikKICAgICAgICB9CiAgICAgICAgW3ZvaWRdJHNiLkFwcGVuZCgnPC90cj4nKQogICAgfQoKICAgIFt2b2lkXSRzYi5BcHBlbmQoJzwvdGJvZHk+PC90YWJsZT4nKQoKICAgICRPdXRwdXRMZW5ndGggPSAkc2IuVG9TdHJpbmcoKSB8IE1lYXN1cmUtT2JqZWN0IC1DaGFyYWN0ZXIgLUlnbm9yZVdoaXRlU3BhY2UgfCBTZWxlY3QtT2JqZWN0IC1FeHBhbmRQcm9wZXJ0eSBDaGFyYWN0ZXJzCiAgICBpZiAoJE91dHB1dExlbmd0aCAtZ3QgMjAwMDAwKSB7CiAgICAgICAgV3JpdGUtV2FybmluZyAoJ091dHB1dCBhcHBlYXJzIHRvIGJlIG92ZXIgdGhlIE5pbmphT25lIFdZU0lXWUcgZmllbGQgbGltaXQgb2YgMjAwLDAwMCBjaGFyYWN0ZXJzLiBBY3R1YWwgbGVuZ3RoIHdhczogezB9JyAtZiAkT3V0cHV0TGVuZ3RoKQogICAgfQoKICAgIHJldHVybiAkc2IuVG9TdHJpbmcoKQp9CgpmdW5jdGlvbiBOZXctVHJlZVNpemVSZXBvcnRIdG1sIHsKICAgIHBhcmFtICgKICAgICAgICBbUGFyYW1ldGVyKE1hbmRhdG9yeSA9ICR0cnVlKV0KICAgICAgICBbb2JqZWN0XSRPYmplY3RzLAogICAgICAgIFtpbnRdJE1pbkl0ZW1TaXplTUIsCiAgICAgICAgW2ludF0kTWF4RGVwdGgsCiAgICAgICAgW2ludF0kVG9wCiAgICApCgogICAgJGxpc3QgPSBpZiAoJE9iamVjdHMgLWlzIFtTeXN0ZW0uQ29sbGVjdGlvbnMuR2VuZXJpYy5MaXN0W29iamVjdF1dKSB7CiAgICAgICAgJE9iamVjdHMKICAgIH0gZWxzZSB7CiAgICAgICAgJHRlbXBMaXN0ID0gW1N5c3RlbS5Db2xsZWN0aW9ucy5HZW5lcmljLkxpc3Rbb2JqZWN0XV06Om5ldygpCiAgICAgICAgZm9yZWFjaCAoJGl0ZW0gaW4gQCgkT2JqZWN0cykpIHsKICAgICAgICAgICAgJG51bGwgPSAkdGVtcExpc3QuQWRkKCRpdGVtKQogICAgICAgIH0KICAgICAgICAkdGVtcExpc3QKICAgIH0KCiAgICBpZiAoJGxpc3QuQ291bnQgLWVxIDApIHsKICAgICAgICByZXR1cm4gJzxwPk5vIGZvbGRlcnMgb3IgZmlsZXMgbWV0IHRoZSBzZWxlY3Rpb24gY3JpdGVyaWEuPC9wPicKICAgIH0KCiAgICAkdGFibGVIdG1sID0gQ29udmVydFRvLU9iamVjdFRvSHRtbFRhYmxlIC1PYmplY3RzICRsaXN0CgogICAgJHRvdGFsQnl0ZXMgPSAoJGxpc3QgfCBNZWFzdXJlLU9iamVjdCAtUHJvcGVydHkgUmF3U2l6ZSAtU3VtKS5TdW0KICAgIGlmICgtbm90ICR0b3RhbEJ5dGVzKSB7CiAgICAgICAgJHRvdGFsQnl0ZXMgPSAwCiAgICB9CgogICAgJGZvcm1hdHRlZFRvdGFsID0gQ29udmVydC1CeXRlc1RvU2l6ZSAtQnl0ZXMgKFtsb25nXSR0b3RhbEJ5dGVzKQogICAgJGRyaXZlQ291bnQgPSAoJGxpc3QgfCBTZWxlY3QtT2JqZWN0IC1FeHBhbmRQcm9wZXJ0eSBEcml2ZSAtVW5pcXVlKS5Db3VudAogICAgJG1pblNpemVTdHJpbmcgPSAnezA6TjB9IE1CJyAtZiBbTWF0aF06Ok1heCgxLCAkTWluSXRlbVNpemVNQikKCiAgICAkc3R5bGUgPSBAIgo8c3R5bGU+Ci50cmVlc2l6ZS1yZXBvcnQgeyBmb250LWZhbWlseTogJ1NlZ29lIFVJJywgQXJpYWwsIHNhbnMtc2VyaWY7IGZvbnQtc2l6ZTogMTJweDsgfQoudHJlZXNpemUtc3VtbWFyeSB7IG1hcmdpbi1ib3R0b206IDEycHg7IH0KLnRyZWVzaXplLXN1bW1hcnkgcCB7IG1hcmdpbjogMCAwIDRweDsgfQoudHJlZXNpemUtdGFibGUgeyB3aWR0aDogMTAwJTsgYm9yZGVyLWNvbGxhcHNlOiBjb2xsYXBzZTsgfQoudHJlZXNpemUtdGFibGUgdGggeyBiYWNrZ3JvdW5kLWNvbG9yOiAjMGQ2ZWZkOyBjb2xvcjogI2ZmZjsgcGFkZGluZzogNnB4OyB0ZXh0LWFsaWduOiBsZWZ0OyB9Ci50cmVlc2l6ZS10YWJsZSB0ZCB7IHBhZGRpbmc6IDZweDsgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNlNWU1ZTU7IH0KLnRyZWVzaXplLXRhYmxlIHRyLmRhbmdlciB7IGJhY2tncm91bmQtY29sb3I6ICNmOGQ3ZGE7IH0KLnRyZWVzaXplLXRhYmxlIHRyLndhcm5pbmcgeyBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmM2NkOyB9Ci50cmVlc2l6ZS10YWJsZSB0ci5pbmZvIHsgYmFja2dyb3VuZC1jb2xvcjogI2NmZjRmYzsgfQoudHJlZXNpemUtdGFibGUgdHIuZGVmYXVsdDpudGgtY2hpbGQoZXZlbikgeyBiYWNrZ3JvdW5kLWNvbG9yOiAjZjhmOWZhOyB9Cjwvc3R5bGU+CiJACgogICAgJHN1bW1hcnkgPSBAIgo8ZGl2IGNsYXNzPSJ0cmVlc2l6ZS1zdW1tYXJ5Ij4KICA8cD48c3Ryb25nPkRyaXZlcyBzY2FubmVkOjwvc3Ryb25nPiAkZHJpdmVDb3VudDwvcD4KICA8cD48c3Ryb25nPkl0ZW1zIHNob3duOjwvc3Ryb25nPiAkKCRsaXN0LkNvdW50KSAodG9wICRUb3AsIG1pbmltdW0gc2l6ZSAkbWluU2l6ZVN0cmluZyk8L3A+CiAgPHA+PHN0cm9uZz5Db21iaW5lZCBzaXplIG9mIGxpc3RlZCBpdGVtczo8L3N0cm9uZz4gJGZvcm1hdHRlZFRvdGFsPC9wPgogIDxwPjxzdHJvbmc+TWF4aW11bSBkZXB0aCBhbmFseXNlZDo8L3N0cm9uZz4gJE1heERlcHRoPC9wPgo8L2Rpdj4KIkAKCiAgICByZXR1cm4gIiR7c3R5bGV9PGRpdiBjbGFzcz1cInRyZWVzaXplLXJlcG9ydFwiPiR7c3VtbWFyeX0ke3RhYmxlSHRtbH08L2Rpdj4iCn0KCiMgVHVuYWJsZSByZXBvcnQgc2V0dGluZ3MKJG1heERlcHRoID0gNQokdG9wUmVzdWx0cyA9IDQwCiRtaW5JdGVtU2l6ZU1iID0gMTAKCiMgR2VuZXJhdGUgdGhlIFRyZWVTaXplIHJlcG9ydAokcmVzdWx0cyA9IEdldC1Gb2xkZXJTaXplcyAtQWxsRHJpdmVzIC1NYXhEZXB0aCAkbWF4RGVwdGggLVRvcCAkdG9wUmVzdWx0cyAtTWluSXRlbVNpemVNQiAkbWluSXRlbVNpemVNYiAtRm9sZGVyU2l6ZSAtRmlsZVNpemUKCmlmICgtbm90ICRyZXN1bHRzIC1vciAkcmVzdWx0cy5Db3VudCAtZXEgMCkgewogICAgJG1pblNpemVOb3RpY2UgPSAnPHA+Tm8gZm9sZGVycyBvciBmaWxlcyBtZXQgdGhlIHNlbGVjdGlvbiBjcml0ZXJpYSAobWluaW11bSBzaXplIHswOk4wfSBNQikuPC9wPicgLWYgW01hdGhdOjpNYXgoMSwgJG1pbkl0ZW1TaXplTWIpCiAgICAkbWluU2l6ZU5vdGljZSB8IE5pbmphLVByb3BlcnR5LVNldC1QaXBlZCB0cmVlc2l6ZQogICAgcmV0dXJuCn0KCiRyZXBvcnRIdG1sID0gTmV3LVRyZWVTaXplUmVwb3J0SHRtbCAtT2JqZWN0cyAkcmVzdWx0cyAtTWluSXRlbVNpemVNQiAkbWluSXRlbVNpemVNYiAtTWF4RGVwdGggJG1heERlcHRoIC1Ub3AgJHRvcFJlc3VsdHMKJHJlcG9ydEh0bWwgfCBOaW5qYS1Qcm9wZXJ0eS1TZXQtUGlwZWQgdHJlZXNpemUK",
  "scriptParameters": [],
  "defaultRunAs": "system",
  "useFirstParametersOptionAsDefault": false
}
